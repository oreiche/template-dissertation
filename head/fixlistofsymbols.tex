% Patch listofsymbols package

% Set indent
\setlength{\symindent}{0em}

\makeatletter

% Fix xspace
\renewcommand{\@createsym}[3]
{\expandafter\newcommand\expandafter{\csname#2\endcsname}
  {\relax\ensuremath{#3}%
   \expandafter\protected@xdef\csname#2isused\endcsname {yes}\spaceaftersym} %evntl. gdef
\expandafter\newcommand\expandafter{\csname#2doc\endcsname}{#1}
\expandafter\newcommand\expandafter{\csname#2tabdoc\endcsname}
  {\ensuremath{#3} & #1}
\expandafter\newcommand\expandafter{\csname#2isused\endcsname}{no}}

% Print dots on line
\renewcommand{\printsymline}[5]
{\expandafter\providecommand\expandafter{\csname#3include\endcsname}{no}
\ifthenelse{\boolean{b@final}
  \AND\(\expandafter\equal{\csname #3include\endcsname}{no}\OR\equal{#4}{}\)}
{\PackageInfo{listofsymbols}{symbol/subscript #3 has no or empty
  description or is not used: omitted}}
{\hspace*{\symindent}\makebox[\symwidth][l]{\ensuremath{#2}}%
\parbox[t]{\textwidth-\symwidth}
{\begin{raggedright}\strut%
\ifthenelse{\boolean{b@final}} {#4\dotfill}%
  {$\backslash$\texttt{#3} --- #4 (\csname #3include\endcsname)}%
\ifthenelse{\boolean{b@pageno}}{#5}{}%
\strut\end{raggedright}}%
\newline}}

% Use chapter instead of section
\ifthenelse{\boolean{b@final}}
{\renewcommand{\symheading}
{\chapter{\symheadingname}}
\renewcommand{\subheading}
{\chapter{\subheadingname}}}
{\renewcommand{\symheading}
{\chapter{\symheadingname\ (draft)}
\makebox[\symwidth+\symindent][l]{\bf Symbol}{\bf Description}
\ifthenelse{\boolean{b@pageno}}{\hfill{\bf Defined on page}}{}}
\renewcommand{\subheading}
{\chapter{\subheadingname\ (draft)}
\makebox[\symwidth+\symindent][l]{\bf Subscript}{\bf Description}
\ifthenelse{\boolean{b@pageno}}{\hfill{\bf Defined on page}}{}}}

\makeatother
